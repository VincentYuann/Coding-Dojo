{% extends "base.html" %} 

{% block head %}
    <title>My To-Do List</title>
{% endblock %} 

{% block body %}
    <header>
        <h1>Welcome, {{ username | safe }}!</h1>
    </header>

    <!-- Add Task Form -->
    <form class="add-task-form" action="{{ url_for('home') }}" method="post">
        <input
            type="text"
            name="content"
            id="content"
            class="form-control"
            placeholder="What needs to be done?"
            required
        />
        <button id="btn_Add" class="btn btn-primary">Add Task</button>
    </form>

    <!-- Task List -->
    <div class="task-list">
        {% if tasks | length < 1 %}
            <h3>You have no tasks. Add one above!</h3>
        {% else %}
            <table class="task-table">
                <thead>
                    <tr>
                        <th>Task</th>
                        <th>Added</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                {% for task in tasks %}
                    <tr>
                        <td>{{ task.content }}</td>
                        <td>{{ task.created.strftime("%b %d, %Y") }}</td>
                        <td>
                            <!-- Actions are grouped with flexbox -->
                            <div class="task-actions">
                                <a href="{{ url_for('update', id=task.id) }}" class="btn btn-secondary">Edit</a>
                                <form action="{{ url_for('delete', id=task.id) }}" method="POST">
                                    <button class="btn btn-danger">Delete</button>
                                </form>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </div>

    <hr />

    <!-- Account Management -->
    <div class="account-actions">
        <form action="{{ url_for('delete_user') }}" method="POST">
            <button
                type="submit"
                class="btn btn-danger"
                onclick="return confirm('Are you sure you want to delete your account? This will delete all your tasks and cannot be undone.')"
            >
                Delete My Account
            </button>
        </form>

        <a href="{{ url_for('logout') }}" class="btn btn-link">Logout</a>
    </div>

    <footer>
        <p>&copy; Vincent Yuan</p>
    </footer>
{% endblock %}
